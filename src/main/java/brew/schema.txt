-- 파일속성
-- auto-generated definition
create table comtnfile
(
    atch_file_id char(20)  not null
        constraint comtnfile_pk
            primary key,
    creat_pnttm  timestamp not null,
    use_at       char      not null
        constraint comtnfile_ck
            check (use_at = ANY (ARRAY ['N'::bpchar, 'Y'::bpchar]))
);

comment on table comtnfile is '파일속성';

comment on column comtnfile.atch_file_id is '첨부파일ID';

comment on column comtnfile.creat_pnttm is '생성시점';

comment on column comtnfile.use_at is '사용여부';

alter table comtnfile
    owner to postgres;

-- 파일상세정보
-- auto-generated definition
create table comtnfiledetail
(
    atch_file_id   char(20)      not null
        constraint comtnfiledetail_fk
            references comtnfile,
    file_sn        numeric(10)   not null,
    file_stre_path varchar(2000) not null,
    stre_file_nm   varchar(256)  not null,
    orignl_file_nm varchar(256),
    file_extsn     varchar(20)   not null,
    file_cn        text,
    file_size      numeric(8),
    constraint comtnfiledetail_pk
        primary key (atch_file_id, file_sn)
);

comment on table comtnfiledetail is '파일상세정보';

comment on column comtnfiledetail.atch_file_id is '첨부파일ID';

comment on column comtnfiledetail.file_sn is '파일순번';

comment on column comtnfiledetail.file_stre_path is '파일저장경로';

comment on column comtnfiledetail.stre_file_nm is '저장파일명';

comment on column comtnfiledetail.orignl_file_nm is '원본파일명';

comment on column comtnfiledetail.file_extsn is '파일확장자';

comment on column comtnfiledetail.file_cn is '파일내용';

comment on column comtnfiledetail.file_size is '파일크기';

alter table comtnfiledetail
    owner to postgres;

-- 게시판
create table comtnbbs
(
    bbs_id       varchar    not null
        constraint comtnbbs_pk
            primary key,
    title        varchar not null,
    contents     varchar not null,
    inq_cnt      integer,
    atch_file_id varchar,
    rgtr_id      varchar,
    rgtr_dt      timestamp,
    mdfr_id      varchar,
    mdfr_dt      timestamp
);

comment on table comtnbbs is '게시판';

comment on column comtnbbs.bbs_id is '일련번호';

comment on column comtnbbs.title is '게시판제목';

comment on column comtnbbs.contents is '게시판내용';

comment on column comtnbbs.inq_cnt is '조회수';

comment on column comtnbbs.atch_file_id is '첨부파일아이디';

comment on column comtnbbs.rgtr_id is '등록자아이디';

comment on column comtnbbs.rgtr_dt is '등록일시';

comment on column comtnbbs.mdfr_id is '수정자아이디';

comment on column comtnbbs.mdfr_dt is '수정일시';

alter table comtnbbs
    owner to postgres;

create index comtnbbs_bbs_id_index
    on comtnbbs (bbs_id);

comment on index comtnbbs_bbs_id_index is '게시판인덱스';

-- FAQ 테이블
create table comtnfaq
(
    faq_id   varchar      not null
        constraint comtnfaq_pk
            primary key,
    title    varchar   not null,
    contents varchar   not null,
    inq_cnt  integer,
    rgtr_id  varchar   not null,
    rgtr_dt  timestamp not null,
    mdfr_id  varchar   not null,
    mdfr_dt  timestamp not null
);

comment on table comtnfaq is '자주물어보는질문';

comment on column comtnfaq.faq_id is '일련번호';

comment on column comtnfaq.title is '제목';

comment on column comtnfaq.contents is '내용';

comment on column comtnfaq.inq_cnt is '조회수';

comment on column comtnfaq.rgtr_id is '등록자';

comment on column comtnfaq.rgtr_dt is '등록일시';

comment on column comtnfaq.mdfr_id is '수정자';

comment on column comtnfaq.mdfr_dt is '수정일시';

alter table comtnfaq
    owner to postgres;

-- 공통코드
create table comtncmmcd
(
    code_id varchar   not null
        constraint comtncmmcd_pk
            primary key,
    code_nm varchar   not null,
    code_dc varchar,
    use_yn  char      not null,
    rgtr_id varchar   not null,
    rgtr_dt timestamp not null,
    mdfr_id varchar   not null,
    mdfr_dt timestamp not null
);

comment on table comtncmmcd is '공통코드';

comment on column comtncmmcd.code_id is '코드ID';

comment on constraint comtncmmcd_pk on comtncmmcd is '코드ID';

comment on column comtncmmcd.code_nm is '코드명';

comment on column comtncmmcd.code_dc is '코드설명';

comment on column comtncmmcd.use_yn is '사용여부';

comment on column comtncmmcd.rgtr_id is '등록자ID';

comment on column comtncmmcd.rgtr_dt is '등록일시';

comment on column comtncmmcd.mdfr_id is '수정자ID';

comment on column comtncmmcd.mdfr_dt is '수정일시';

alter table comtncmmcd
    owner to postgres;

-- 공통코드 상세
create table comtncmmcddtls
(
    code_id varchar   not null,
    code    varchar   not null,
    code_nm varchar   not null,
    code_dc varchar,
    use_yn  char      not null,
    rgtr_id varchar   not null,
    rgtr_dt timestamp not null,
    mdfr_id varchar   not null,
    mdfr_dt timestamp not null,
    constraint comtncmmcddtls_pk
        primary key (code_id, code, code_nm)
);

comment on table comtncmmcddtls is '공통코드상세';

comment on column comtncmmcddtls.code_id is '코드ID';

comment on column comtncmmcddtls.code is '코드';

comment on column comtncmmcddtls.code_nm is '코드명';

comment on column comtncmmcddtls.code_dc is '코드설명';

comment on column comtncmmcddtls.use_yn is '사용여부';

comment on column comtncmmcddtls.rgtr_id is '등록자ID';

comment on column comtncmmcddtls.rgtr_dt is '등록일시';

comment on column comtncmmcddtls.mdfr_id is '수정자ID';

comment on column comtncmmcddtls.mdfr_dt is '수정일시';

alter table comtncmmcddtls
    owner to postgres;

create index comtncmmcddtls_code_id_code_index
    on comtncmmcddtls (code_id, code);

-- 로그인

create table brewlogin
(
    user_sn           varchar   not null
        constraint brewlogin_pk
            primary key,
    user_id           varchar   not null,
    nick_nm           varchar,
    profile_img_url   varchar,
    user_nm           varchar,
    use_yn            char      not null,
    login_se          varchar   not null,
    rgtr_id           varchar   not null,
    rgtr_dt           timestamp not null,
    mdfr_id           varchar   not null,
    mdfr_dt           timestamp not null,
    auth_cd           varchar   not null,
    thumbnail_img_url varchar,
    exit_yn           varchar   not null,
    given_nm          varchar,
    family_nm         varchar,
    email_verified    varchar,
    email             varchar,
    birth_year        varchar,
    birth_day         varchar,
    mobile            varchar,
    mobile_e          varchar,
    age               varchar,
    gender            varchar
);

comment on table brewlogin is '로그인';

comment on column brewlogin.user_sn is '일련번호';

comment on column brewlogin.user_id is '사용자ID';

comment on column brewlogin.nick_nm is '닉네임';

comment on column brewlogin.profile_img_url is '프로필이미지경로';

comment on column brewlogin.user_nm is '사용자명';

comment on column brewlogin.use_yn is '사용여부';

comment on column brewlogin.login_se is '로그인구분';

comment on column brewlogin.rgtr_id is '등록자ID';

comment on column brewlogin.rgtr_dt is '등록일시';

comment on column brewlogin.mdfr_id is '수정자ID';

comment on column brewlogin.mdfr_dt is '수정일시';

comment on column brewlogin.auth_cd is '권한코드';

comment on column brewlogin.thumbnail_img_url is '썸네일이미지경로';

comment on column brewlogin.exit_yn is '탈퇴여부';

comment on column brewlogin.given_nm is '이름';

comment on column brewlogin.family_nm is '성';

comment on column brewlogin.email_verified is '이메일인증여부';

comment on column brewlogin.email is '이메일';

comment on column brewlogin.birth_year is '출생연도';

comment on column brewlogin.birth_day is '출생월일';

comment on column brewlogin.mobile is '핸드폰번호';

comment on column brewlogin.mobile_e is '국적핸드폰번호';

comment on column brewlogin.age is '연령대';

comment on column brewlogin.gender is '성별';

alter table brewlogin
    owner to postgres;

create index brewlogin_sn_idx
    on brewlogin (user_sn);

create index brewsignin_sn_idx
    on brewlogin (user_sn);

-- 회원탈퇴 내역 테이블

create table brewexit
(
    exit_sn           varchar                                      not null
        constraint brewexit_pk
            primary key,
    user_sn           varchar                                      not null,
    user_id           varchar                                      not null,
    nick_nm           varchar,
    profile_img_url   varchar,
    user_nm           varchar,
    use_yn            varchar,
    login_se          varchar,
    auth_cd           varchar,
    thumbnail_img_url varchar,
    revival_yn        varchar   default 'N'::character varying     not null,
    rgtr_id           varchar                                      not null,
    rgtr_dt           timestamp                                    not null,
    mdfr_id           varchar   default 'admin'::character varying not null,
    mdfr_dt           timestamp default CURRENT_TIMESTAMP          not null
);

comment on table brewexit is '회원탈퇴';

comment on column brewexit.exit_sn is '회원탈퇴일련번호';

comment on column brewexit.user_sn is '일련번호';

comment on column brewexit.user_id is '사용자ID';

comment on column brewexit.nick_nm is '닉네임';

comment on column brewexit.profile_img_url is '프로필이미지경로';

comment on column brewexit.user_nm is '사용자명';

comment on column brewexit.use_yn is '사용여부';

comment on column brewexit.login_se is '로그인구분';

comment on column brewexit.auth_cd is '권한코드';

comment on column brewexit.thumbnail_img_url is '썸네일이미지경로';

comment on column brewexit.revival_yn is '복구여부';

comment on column brewexit.rgtr_id is '등록자ID';

comment on column brewexit.rgtr_dt is '등록일시';

comment on column brewexit.mdfr_id is '수정자ID';

comment on column brewexit.mdfr_dt is '수정일시';

alter table brewexit
    owner to postgres;

create index brewexit_exit_sn_index
    on brewexit (exit_sn);

-- 회원가입내역

create table brewsignin
(
    user_sn           varchar,
    user_id           varchar,
    nick_nm           varchar,
    profile_img_url   varchar,
    user_nm           varchar,
    use_yn            char,
    login_se          varchar,
    auth_cd           varchar,
    thumbnail_img_url varchar,
    exit_yn           varchar,
    rgtr_id           varchar   not null,
    rgtr_dt           timestamp not null,
    mdfr_id           varchar   not null,
    mdfr_dt           timestamp not null,
    email             varchar
);

comment on table brewsignin is '회원가입내역';

comment on column brewsignin.user_sn is '일련번호';

comment on column brewsignin.user_id is '사용자ID';

comment on column brewsignin.nick_nm is '닉네임';

comment on column brewsignin.profile_img_url is '프로필이미지경로';

comment on column brewsignin.user_nm is '사용자명';

comment on column brewsignin.use_yn is '사용여부';

comment on column brewsignin.login_se is '로그인구분';

comment on column brewsignin.auth_cd is '권한코드';

comment on column brewsignin.thumbnail_img_url is '썸네일이미지경로';

comment on column brewsignin.exit_yn is '탈퇴여부';

comment on column brewsignin.rgtr_id is '등록자ID';

comment on column brewsignin.rgtr_dt is '등록일시';

comment on column brewsignin.mdfr_id is '수정자ID';

comment on column brewsignin.mdfr_dt is '수정일시';

comment on column brewsignin.email is '이메일';

alter table brewsignin
    owner to postgres;


-- 문의사항

create table brewcst
(
    sn          integer not null
        constraint brewcst_pk
            primary key,
    title       varchar not null,
    contents    varchar not null,
    inq_cnt     integer,
    atchfile_id varchar,
    rgtr_id     varchar,
    rgtr_dt     timestamp,
    mdfr_id     varchar,
    mdfr_dt     timestamp
);

comment on table brewcst is '문의사항';

comment on column brewcst.sn is '일련번호';

comment on column brewcst.title is '게시판제목';

comment on column brewcst.contents is '게시판내용';

comment on column brewcst.inq_cnt is '조회수';

comment on column brewcst.atchfile_id is '첨부파일아이디';

comment on column brewcst.rgtr_id is '등록자아이디';

comment on column brewcst.rgtr_dt is '등록일시';

comment on column brewcst.mdfr_id is '수정자아이디';

comment on column brewcst.mdfr_dt is '수정일시';

alter table brewcst
    owner to postgres;

create index brewcst_sn_index
    on brewcst (sn);

comment on index brewcst_sn_index is '문의사항인덱스';

-- 시퀀스 테이블
create table comtecopseq
(
    table_name varchar(20) not null
        constraint comtecopseq_pk
            primary key,
    next_id    numeric(30)
);

comment on table comtecopseq is 'COMTECOPSEQ';

comment on column comtecopseq.table_name is '테이블명';

comment on column comtecopseq.next_id is '다음ID';

alter table comtecopseq
    owner to postgres;

INSERT INTO brew.comtecopseq (table_name, next_id) VALUES ('FILE_ID', 0);
INSERT INTO brew.comtecopseq (table_name, next_id) VALUES ('LOG_ID', 0);
INSERT INTO brew.comtecopseq (table_name, next_id) VALUES ('LGI_ID', 0);
INSERT INTO brew.comtecopseq (table_name, next_id) VALUES ('BBS_ID', 0);
INSERT INTO brew.comtecopseq (table_name, next_id) VALUES ('FAQ_ID', 0);
INSERT INTO brew.comtecopseq (table_name, next_id) VALUES ('CODE_ID', 0);

-- 방문자 이력로그
create table comtnvisitorlog
(
    log_id     char(20) not null
        constraint comtnvisitorlog_pk
            primary key,
    session_id varchar,
    client_ip  varchar,
    rgtr_dt    timestamp
);

comment on table comtnvisitorlog is '방문자이력';

comment on column comtnvisitorlog.log_id is '로그ID';

comment on column comtnvisitorlog.session_id is '세션ID';

comment on column comtnvisitorlog.client_ip is '클라이언트IP';

comment on column comtnvisitorlog.rgtr_dt is '등록일시';

alter table comtnvisitorlog
    owner to postgres;


-- 로그인이력

create table comtnloginlog
(
    log_id   varchar not null
        constraint comtnloginlog_pk
            primary key,
    user_sn  varchar not null,
    user_id  varchar,
    user_nm  varchar,
    nick_nm  varchar,
    email    varchar,
    auth_cd  varchar,
    login_se varchar,
    rgtr_dt  timestamp
);

comment on table comtnloginlog is '로그인이력';

comment on column comtnloginlog.user_sn is '사용자일련번호';

comment on column comtnloginlog.user_id is '유저아이디';

comment on column comtnloginlog.user_nm is '유저명';

comment on column comtnloginlog.nick_nm is '닉네임';

comment on column comtnloginlog.email is '이메일';

comment on column comtnloginlog.auth_cd is '권한코드';

comment on column comtnloginlog.login_se is '연계SNS';

comment on column comtnloginlog.rgtr_dt is '등록일시';

comment on column comtnloginlog.log_id is '로그아이디';

alter table comtnloginlog
    owner to postgres;
